#go 单机websocket程序
###模式分为拉模式和推模式
- 拉取模式 轮询的原理不推荐
- 推送模式 推荐
###技术选型
- nodejs单线程 推送能力有限
- c/c++轮子太少 开发成本高
- go有成熟的组件和websocket标准库，支持多线程高并发
###瓶颈
- 内核瓶颈 内核每秒最多可处理100万个包
- 锁瓶颈 操作长连接保存的集合的时候需要加锁
- CPU瓶颈 发送json字符串 对CPU资源消耗较大
###瓶颈的应对
- 内核瓶颈 将1秒内发送的包合并为1个 减少包的量
- 锁瓶颈 将长连接存储到不同的集合中，分别加锁
读写锁替代互斥锁
- CPU减少重复计算
###单机瓶颈
- 单机内存有限
- CPU性能有限
- 带宽有限
### 摆脱单机使用分布式架构
- 网管层广播
- http/2 RPC通讯
- http/1 业务接口
### go mod包管理